{% extends "registration/base.html" %}
{% block title %}Log in · SimpleTix{% endblock %}

{% block content %}
  <div class="card shadow-sm p-4">
    <h1 class="mb-3">Log in</h1>

    {# Role hint #}
    {% if request.GET.role %}
      <div class="alert alert-info mb-3">
        You’re continuing as <strong>{{ request.GET.role|title }}</strong>.
      </div>
    {% endif %}

    {# Invalid credentials etc. #}
    {% if form.non_field_errors %}
      <div class="alert alert-danger">{{ form.non_field_errors }}</div>
    {% endif %}

    <form method="post" novalidate>
      {% csrf_token %}

      {# Preserve role/next across POST #}
      {% if request.GET.role %}
        <input type="hidden" name="role" value="{{ request.GET.role }}">
      {% endif %}
      {% if request.GET.next %}
        <input type="hidden" name="next" value="{{ request.GET.next }}">
      {% endif %}

      <div class="mb-3">
        <label class="form-label" for="{{ form.username.id_for_label }}">Username</label>
        {{ form.username }}
        {% if form.username.errors %}
          <div class="text-danger small">{{ form.username.errors }}</div>
        {% endif %}
      </div>

      <div class="mb-4">
        <label class="form-label" for="{{ form.password.id_for_label }}">Password</label>
        {{ form.password }}
        {% if form.password.errors %}
          <div class="text-danger small">{{ form.password.errors }}</div>
        {% endif %}
      </div>

      <div class="d-flex gap-2 align-items-center">
        <button class="btn btn-primary" type="submit">Log in</button>
        <a class="btn btn-outline-secondary" href="/">Cancel</a>

        <span class="ms-auto">
          Don’t have an account?
          <a href="{% url 'accounts:signup' %}{% if request.GET.role %}?role={{ request.GET.role }}{% endif %}">
            Create account
          </a>
        </span>
      </div>
    </form>
  </div>
{% endblock %}
