{% extends "registration/base.html" %}
{% block title %}Create Account · SimpleTix{% endblock %}

{% block content %}
  <div class="card shadow-sm p-4">
    <h1 class="mb-1">Create Account</h1>
    <p class="text-muted mb-3">Pick a username and password to get started.</p>

    {% if request.GET.role %}
      <div class="alert alert-info mb-3">
        You’re creating an <strong>{{ request.GET.role|title }}</strong> account.
      </div>
    {% endif %}

    {% if form.non_field_errors %}
      <div class="alert alert-danger">
        {{ form.non_field_errors }}
      </div>
    {% endif %}

    <form method="post" novalidate>
      {% csrf_token %}

      {% if request.GET.role %}
        <input type="hidden" name="role" value="{{ request.GET.role }}">
      {% endif %}
      {% if request.GET.next %}
        <input type="hidden" name="next" value="{{ request.GET.next }}">
      {% endif %}

      <div class="mb-3">
        <label class="form-label" for="{{ form.username.id_for_label }}">Username</label>
        {{ form.username }}
        {% if form.username.errors %}
          <div class="text-danger small">{{ form.username.errors }}</div>
        {% endif %}
      </div>

      <div class="mb-3">
        <label class="form-label" for="{{ form.password1.id_for_label }}">Password</label>
        {{ form.password1 }}
        {% if form.password1.help_text %}
          <div class="form-text">{{ form.password1.help_text|safe }}</div>
        {% endif %}
        {% if form.password1.errors %}
          <div class="text-danger small">{{ form.password1.errors }}</div>
        {% endif %}
      </div>

      <div class="mb-4">
        <label class="form-label" for="{{ form.password2.id_for_label }}">Confirm password</label>
        {{ form.password2 }}
        {% if form.password2.errors %}
          <div class="text-danger small">{{ form.password2.errors }}</div>
        {% endif %}
      </div>

      <div class="d-flex gap-2">
        <button class="btn btn-primary" type="submit">Create Account</button>
        {# WAS: {% url 'home:home' %} — that namespace no longer exists #}
       <a class="btn btn-outline-secondary" href="/">Cancel</a>
        <span class="ms-auto">
          Already have an account?
          <a href="{% url 'accounts:login' %}{% if request.GET.role %}?role={{ request.GET.role }}{% endif %}">
            Log in
          </a>
        </span>
      </div>
    </form>
  </div>
{% endblock %}
