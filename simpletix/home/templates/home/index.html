{% extends "base.html" %}
{% block title %}SimpleTix ¬∑ Home{% endblock %}

{% block content %}
  <div class="card">
    <h1>Welcome to SimpleTix</h1>
    <p class="muted">Create events. Sell tickets. Verify instantly.</p>
    <div class="form-actions">
      <a class="btn btn-primary" href="{% url 'accounts:signup' %}?next={{ request.path }}">Create Account</a>
    </div>
  </div>
{% endblock %}

<section class="container mt-4">
  <h2>üîç Algolia Test Search</h2>
  <div id="algolia-test-searchbox"></div>
  <div id="algolia-test-results"
       class="border rounded mt-2 p-2"
       style="max-height: 300px; overflow-y: auto;">
  </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/algoliasearch@4.22.1/dist/algoliasearch-lite.umd.js"></script>
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4.59.1/dist/instantsearch.production.min.js"></script>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const ALGOLIA_APP_ID = "KFIC62EZAO";
    const ALGOLIA_SEARCH_KEY = "4fe1741215a5a5ef75ed0847d66dbd64";
    const ALGOLIA_INDEX = "simpletix_simpletix_events"; // or just 'simpletix_events' if you want to test both

    const searchClient = algoliasearch(ALGOLIA_APP_ID, ALGOLIA_SEARCH_KEY);
    const search = instantsearch({
      indexName: ALGOLIA_INDEX,
      searchClient,
    });

    search.addWidgets([
      instantsearch.widgets.searchBox({
        container: '#algolia-test-searchbox',
        placeholder: 'Search events...',
        showReset: true,
        showSubmit: true,
      }),

      instantsearch.widgets.hits({
        container: '#algolia-test-results',
        templates: {
          item(hit) {
            return `
              <div class="border-bottom p-2">
                <strong>${hit.title}</strong><br>
                <small>${hit.location || ''}</small>
              </div>
            `;
          },
          empty: `<div class="p-2 text-muted">No events found</div>`,
        },
      }),
    ]);

    search.start();
  });
</script>
